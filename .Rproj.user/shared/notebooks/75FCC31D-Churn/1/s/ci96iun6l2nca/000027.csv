"0",""
"0","mydata <- KMeansData"
"0","rows <- nrow(mydata)"
"0","set.seed(12345)"
"0","trainIndex <- sample(rows, 0.6*rows, replace=FALSE)"
"0","training <- mydata[trainIndex,]"
"0","validation <- mydata[-trainIndex,]"
"0","mylogit <- glm(as.factor(left)~satisfactionlevel+lastevaluation+numberproject+averagemontlyhours+timespendcompany+Workaccident+promotionlast5years, data=training, family=binomial)"
"0","backward <- step(mylogit, direction='backward')"
"1","Start:  AIC="
"1",""
"1","8063.24"
"1",""
"1","
"
"1",""
"1","as.factor(left) ~ satisfactionlevel + lastevaluation + numberproject + "
"1",""
"1","
    averagemontlyhours + timespendcompany + Workaccident + promotionlast5years"
"1",""
"1","

"
"1","                     "
"1"," Df"
"1"," Deviance"
"1","    AIC"
"1","
<none>               "
"1","   "
"1","   8047.2"
"1"," 8063.2"
"1","
- lastevaluation     "
"1","  1"
"1","   8067.6"
"1"," 8081.6"
"1","
- averagemontlyhours "
"1","  1"
"1","   8090.2"
"1"," 8104.2"
"1","
- promotionlast5years"
"1","  1"
"1","   8093.2"
"1"," 8107.2"
"1","
- timespendcompany   "
"1","  1"
"1","   8159.3"
"1"," 8173.3"
"1","
- numberproject      "
"1","  1"
"1","   8175.1"
"1"," 8189.1"
"1","
- Workaccident       "
"1","  1"
"1","   8236.6"
"1"," 8250.6"
"1","
- satisfactionlevel  "
"1","  1"
"1","   9350.9"
"1"," 9364.9"
"1","
"
"0","mylogit <- backward"
"0","mylogitProbs <- predict(mylogit, validation, type=""response"")"
"0","matrix <- confusionMatrix(validation$left, mylogitProbs, threshold=0.35)"
"0","acc <- accuracy(validation$left, mylogitProbs, threshold=0.35)"
"0","missClass <- 1 - sum(diag(matrix))/sum(matrix)"
"0","accuracyValue <- sum(diag(matrix))/sum(matrix)"
"0","mydf <- cbind(validation, mylogitProbs)"
"0","mydf$response <- as.factor(ifelse(mydf$mylogitProbs>0.5,1,0))"
"0","logitScores <- prediction(mydf$mylogitProbs, labels=mydf$left)"
"0","logitPerf <- performance(logitScores, ""tpr"", ""fpr"")"
"0","plot(logitPerf, main=""ROC Curve"", xlab=""1 - Specificity"", ylab=""Sensitivity"", col=""darkblue"", lwd=3)"
