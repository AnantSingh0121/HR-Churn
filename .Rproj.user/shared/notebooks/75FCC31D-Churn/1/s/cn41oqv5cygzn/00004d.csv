"0","library(ROCR)"
"0","mydata <- KMeansData"
"0","rows <- nrow(mydata)"
"0","set.seed(12345)"
"0","trainIndex <- sample(rows, 0.6*rows, replace=FALSE)"
"0","training <- mydata[trainIndex,]"
"0","validation <- mydata[-trainIndex,]"
"0","mylogit <- glm(as.factor(left)~satisfactionlevel+lastevaluation+numberproject+averagemontlyhours+timespendcompany+Workaccident+promotionlast5years, data=training, family=binomial)"
"0","summary(mylogit)"
"1","
Call:
"
"1",""
"1","glm(formula = as.factor(left) ~ satisfactionlevel + lastevaluation + 
    numberproject + averagemontlyhours + timespendcompany + Workaccident + 
    promotionlast5years, family = binomial, data = training)"
"1",""
"1","
"
"1","
Coefficients:
"
"1","                   "
"1"," Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","    "
"1","
(Intercept)        "
"1","  0.32994"
"1","    0.08925"
"1","   3.697"
"1"," 0.000218"
"1"," ***"
"1","
satisfactionlevel  "
"1"," -3.70001"
"1","    0.11296"
"1"," -32.755"
"1","  < 2e-16"
"1"," ***"
"1","
lastevaluation     "
"1","  0.53866"
"1","    0.11966"
"1","   4.501"
"1"," 6.75e-06"
"1"," ***"
"1","
numberproject      "
"1"," -1.48139"
"1","    0.13372"
"1"," -11.078"
"1","  < 2e-16"
"1"," ***"
"1","
averagemontlyhours "
"1","  0.90882"
"1","    0.13938"
"1","   6.521"
"1"," 7.00e-11"
"1"," ***"
"1","
timespendcompany   "
"1","  1.61853"
"1","    0.15068"
"1","  10.741"
"1","  < 2e-16"
"1"," ***"
"1","
Workaccident       "
"1"," -1.32651"
"1","    0.10877"
"1"," -12.195"
"1","  < 2e-16"
"1"," ***"
"1","
promotionlast5years"
"1"," -1.73560"
"1","    0.30866"
"1","  -5.623"
"1"," 1.88e-08"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","binomial"
"1",""
"1"," family taken to be "
"1",""
"1","1"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 9811.6  on 8998  degrees of freedom
"
"1",""
"1","Residual deviance: 8047.2  on 8991  degrees of freedom
"
"1","AIC: "
"1",""
"1","8063.2"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","5"
"1",""
"1","
"
"1","
"
"0","coef(mylogit)"
"1","        (Intercept) "
"1","  satisfactionlevel "
"1","     lastevaluation "
"1","      numberproject "
"1","
"
"1","          0.3299391 "
"1","         -3.7000125 "
"1","          0.5386622 "
"1","         -1.4813909 "
"1","
"
"1"," averagemontlyhours "
"1","   timespendcompany "
"1","       Workaccident "
"1","promotionlast5years "
"1","
"
"1","          0.9088224 "
"1","          1.6185266 "
"1","         -1.3265084 "
"1","         -1.7356001 "
"1","
"
"0","mylogitProbs <- predict(mylogit, validation, type=""response"")"
"0","confusionMatrix <- function(actual, predictedProb, threshold=0.5){pred <- ifelse(predictedProb>threshold,1,0); table(Predicted=pred, Actual=actual)}"
"0","accuracy <- function(actual, predictedProb, threshold=0.5){pred <- ifelse(predictedProb>threshold,1,0); cm <- table(Predicted=pred, Actual=actual); sum(diag(cm))/sum(cm)}"
"0","matrix <- confusionMatrix(validation$left, mylogitProbs, threshold=0.35)"
"0","acc <- accuracy(validation$left, mylogitProbs, threshold=0.35)"
"0","missClass <- 1 - sum(diag(matrix))/sum(matrix)"
"0","accuracyValue <- sum(diag(matrix))/sum(matrix)"
"0","mydf <- cbind(validation, mylogitProbs)"
"0","mydf$response <- as.factor(ifelse(mydf$mylogitProbs>0.5,1,0))"
"0","logitScores <- prediction(mydf$mylogitProbs, labels=mydf$left)"
"0","logitPerf <- performance(logitScores, ""tpr"", ""fpr"")"
"0","plot(logitPerf, main=""ROC Curve"", xlab=""1 - Specificity"", ylab=""Sensitivity"", col=""blue"", lwd=3)"
